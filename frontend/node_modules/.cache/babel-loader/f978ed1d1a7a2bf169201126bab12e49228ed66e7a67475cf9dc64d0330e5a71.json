{"ast":null,"code":"import React from'react';import{useState}from'react';import AiResponseField from'./AiResponseField';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const QuestionToAI=()=>{const[userInput,setUserInput]=useState({'user_input':''});const[aiOutput,setAiOutput]=useState('');const[isLoading,setIsLoading]=useState(false);const[controller,setController]=useState(null);const token=localStorage.getItem('token');const sendingQuestion=async()=>{const newController=new AbortController();setController(newController);setIsLoading(true);setAiOutput('');try{const response=await fetch('http://127.0.0.1:8000/users/question',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(userInput),signal:newController.signal});if(!response.ok){if(response.status===429){const errorData=await response.json();throw new Error(errorData.detail||'現在別の処理を行っています。10秒ほど待って再度操作を行ってください。');}throw new Error('AIが回答に失敗しました');}setAiOutput(await response.json());setUserInput({'user_input':''});}catch(error){if(error.name==='AbortError'){setAiOutput('');}else{alert(error.message);}}finally{setIsLoading(false);}};const stopRequest=()=>{if(controller)controller.abort();};const handleChangeUserInput=e=>{setUserInput({'user_input':e.target.value});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"question-to-ai\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cautionary-note\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u203B\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text\",children:[\"\\u3053\\u306EAI\\u306F\\u69D8\\u3005\\u306A\\u75C5\\u6C17\\u306B\\u95A2\\u3059\\u308B\\u60C5\\u5831\\u3092\\u53C2\\u7167\\u3055\\u305B\\u3066\\u3044\\u308B\\u305F\\u3081\\u3001\\u69D8\\u3005\\u306A\\u75C5\\u6C17\\u306B\\u95A2\\u3059\\u308B\\u3053\\u3068\\u304C\\u56DE\\u7B54\\u306B\\u542B\\u307E\\u308C\\u308B\\u3053\\u3068\\u304C\\u3042\\u308A\\u307E\\u3059\\u3002\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u3057\\u304B\\u3057\\u91CD\\u8981\\u306A\\u306E\\u306F\\u307E\\u305A\\u7363\\u533B\\u5E2B\\u306B\\u76F8\\u8AC7\\u3059\\u308B\\u3053\\u3068\\u3067\\u3059\\u3002AI\\u306E\\u56DE\\u7B54\\u306F\\u53C2\\u8003\\u7A0B\\u5EA6\\u306B\\u8003\\u3048\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\",/*#__PURE__*/_jsx(\"br\",{})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"question-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"question-container\",value:userInput.user_input,onChange:handleChangeUserInput}),isLoading?/*#__PURE__*/_jsx(\"button\",{className:\"send-button\",onClick:stopRequest,children:/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",children:\"autostop\"})}):/*#__PURE__*/_jsx(\"button\",{className:\"send-button\",onClick:sendingQuestion,disabled:isLoading||userInput.user_input.trim()==='',children:/*#__PURE__*/_jsx(\"span\",{className:\"material-symbols-outlined\",children:\"autoplay\"})})]}),isLoading?/*#__PURE__*/// <p className='tag loading-animation'>回答生成中...</p>\n_jsxs(\"div\",{className:\"tag loading-animation\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u56DE\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u7B54\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u751F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u6210\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u4E2D\"}),/*#__PURE__*/_jsx(\"span\",{children:\".\"}),/*#__PURE__*/_jsx(\"span\",{children:\".\"}),/*#__PURE__*/_jsx(\"span\",{children:\".\"})]}):/*#__PURE__*/_jsx(\"p\",{className:\"tag\",children:\"AI\\u304B\\u3089\\u306E\\u56DE\\u7B54\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(AiResponseField,{aiOutput:aiOutput})]})});};export default QuestionToAI;","map":{"version":3,"names":["React","useState","AiResponseField","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","QuestionToAI","userInput","setUserInput","aiOutput","setAiOutput","isLoading","setIsLoading","controller","setController","token","localStorage","getItem","sendingQuestion","newController","AbortController","response","fetch","method","headers","concat","body","JSON","stringify","signal","ok","status","errorData","json","Error","detail","error","name","alert","message","stopRequest","abort","handleChangeUserInput","e","target","value","children","className","user_input","onChange","onClick","disabled","trim"],"sources":["C:/Users/ayuto/github/health-care-application/frontend/src/compornent/QuestionToAI.js"],"sourcesContent":["import React from 'react'\r\nimport { useState } from 'react'\r\nimport AiResponseField from './AiResponseField';\r\n\r\nconst QuestionToAI = () => {\r\n    const [userInput, setUserInput] = useState({\r\n        'user_input': '',\r\n    });\r\n    const [aiOutput, setAiOutput] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [controller, setController] = useState(null);\r\n    const token = localStorage.getItem('token');\r\n\r\n    const sendingQuestion = async() => {\r\n        const newController = new AbortController();\r\n        setController(newController);\r\n        setIsLoading(true);\r\n        setAiOutput('');\r\n        try {\r\n            const response = await fetch('http://127.0.0.1:8000/users/question', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n                body: JSON.stringify(userInput),\r\n                signal: newController.signal,\r\n            });\r\n            if (!response.ok) {\r\n                if (response.status === 429) {\r\n                    const errorData = await response.json();\r\n                    throw new Error(errorData.detail || '現在別の処理を行っています。10秒ほど待って再度操作を行ってください。');\r\n                }\r\n                throw new Error('AIが回答に失敗しました');\r\n            }\r\n            setAiOutput(await response.json());\r\n            setUserInput({'user_input': ''});\r\n        } catch (error) {\r\n            if (error.name === 'AbortError') {\r\n                setAiOutput('')\r\n            } else {\r\n                alert(error.message);\r\n            }\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }\r\n    const stopRequest = () => {\r\n        if (controller) controller.abort();\r\n    }\r\n\r\n    const handleChangeUserInput = (e) => {\r\n        setUserInput({\r\n            'user_input': e.target.value\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className='question-to-ai'>\r\n                <div className='cautionary-note'>\r\n                    <p>※</p>\r\n                    <p className='text'>\r\n                        このAIは様々な病気に関する情報を参照させているため、様々な病気に関することが回答に含まれることがあります。<br />\r\n                        しかし重要なのはまず獣医師に相談することです。AIの回答は参考程度に考えてください。<br />\r\n                    </p>\r\n                </div>\r\n                <div className='question-form'>\r\n                    <textarea className='question-container' value={userInput.user_input} onChange={handleChangeUserInput}></textarea>\r\n                    {isLoading ? \r\n                    (\r\n                        <button className='send-button' onClick={stopRequest}> \r\n                            <span className='material-symbols-outlined'>autostop</span>            \r\n                        </button>\r\n                    ) : \r\n                    (\r\n                        <button \r\n                        className='send-button' \r\n                        onClick={sendingQuestion}\r\n                        disabled={isLoading || userInput.user_input.trim() === ''}\r\n                        > \r\n                            <span className='material-symbols-outlined'>autoplay</span>            \r\n                        </button>\r\n                    )}\r\n                </div>\r\n                {isLoading ? \r\n                (\r\n                    // <p className='tag loading-animation'>回答生成中...</p>\r\n                    <div className='tag loading-animation'>\r\n                        <span>回</span>\r\n                        <span>答</span>\r\n                        <span>生</span>\r\n                        <span>成</span>\r\n                        <span>中</span>\r\n                        <span>.</span>\r\n                        <span>.</span>\r\n                        <span>.</span>\r\n                    </div>\r\n                ) : \r\n                (\r\n                    <p className='tag'>AIからの回答</p>\r\n                )}\r\n                <hr/>\r\n                <AiResponseField aiOutput={aiOutput} />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default QuestionToAI"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,OAAO,CAChC,MAAO,CAAAC,eAAe,KAAM,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEhD,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACvB,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGV,QAAQ,CAAC,CACvC,YAAY,CAAE,EAClB,CAAC,CAAC,CACF,KAAM,CAACW,QAAQ,CAAEC,WAAW,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACa,SAAS,CAAEC,YAAY,CAAC,CAAGd,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACe,UAAU,CAAEC,aAAa,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAClD,KAAM,CAAAiB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,KAAM,CAAAC,eAAe,CAAG,KAAAA,CAAA,GAAW,CAC/B,KAAM,CAAAC,aAAa,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CAC3CN,aAAa,CAACK,aAAa,CAAC,CAC5BP,YAAY,CAAC,IAAI,CAAC,CAClBF,WAAW,CAAC,EAAE,CAAC,CACf,GAAI,CACA,KAAM,CAAAW,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,sCAAsC,CAAE,CACjEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACL,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAC,MAAA,CAAYV,KAAK,CACpC,CAAC,CACDW,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACrB,SAAS,CAAC,CAC/BsB,MAAM,CAAEV,aAAa,CAACU,MAC1B,CAAC,CAAC,CACF,GAAI,CAACR,QAAQ,CAACS,EAAE,CAAE,CACd,GAAIT,QAAQ,CAACU,MAAM,GAAK,GAAG,CAAE,CACzB,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAX,QAAQ,CAACY,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAC,KAAK,CAACF,SAAS,CAACG,MAAM,EAAI,qCAAqC,CAAC,CAC9E,CACA,KAAM,IAAI,CAAAD,KAAK,CAAC,cAAc,CAAC,CACnC,CACAxB,WAAW,CAAC,KAAM,CAAAW,QAAQ,CAACY,IAAI,CAAC,CAAC,CAAC,CAClCzB,YAAY,CAAC,CAAC,YAAY,CAAE,EAAE,CAAC,CAAC,CACpC,CAAE,MAAO4B,KAAK,CAAE,CACZ,GAAIA,KAAK,CAACC,IAAI,GAAK,YAAY,CAAE,CAC7B3B,WAAW,CAAC,EAAE,CAAC,CACnB,CAAC,IAAM,CACH4B,KAAK,CAACF,KAAK,CAACG,OAAO,CAAC,CACxB,CACJ,CAAC,OAAS,CACN3B,YAAY,CAAC,KAAK,CAAC,CACvB,CACJ,CAAC,CACD,KAAM,CAAA4B,WAAW,CAAGA,CAAA,GAAM,CACtB,GAAI3B,UAAU,CAAEA,UAAU,CAAC4B,KAAK,CAAC,CAAC,CACtC,CAAC,CAED,KAAM,CAAAC,qBAAqB,CAAIC,CAAC,EAAK,CACjCnC,YAAY,CAAC,CACT,YAAY,CAAEmC,CAAC,CAACC,MAAM,CAACC,KAC3B,CAAC,CAAC,CACN,CAAC,CAED,mBACI5C,IAAA,CAAAI,SAAA,EAAAyC,QAAA,cACI3C,KAAA,QAAK4C,SAAS,CAAC,gBAAgB,CAAAD,QAAA,eAC3B3C,KAAA,QAAK4C,SAAS,CAAC,iBAAiB,CAAAD,QAAA,eAC5B7C,IAAA,MAAA6C,QAAA,CAAG,QAAC,CAAG,CAAC,cACR3C,KAAA,MAAG4C,SAAS,CAAC,MAAM,CAAAD,QAAA,EAAC,4TACsC,cAAA7C,IAAA,QAAK,CAAC,qPAClB,cAAAA,IAAA,QAAK,CAAC,EACjD,CAAC,EACH,CAAC,cACNE,KAAA,QAAK4C,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC1B7C,IAAA,aAAU8C,SAAS,CAAC,oBAAoB,CAACF,KAAK,CAAEtC,SAAS,CAACyC,UAAW,CAACC,QAAQ,CAAEP,qBAAsB,CAAW,CAAC,CACjH/B,SAAS,cAENV,IAAA,WAAQ8C,SAAS,CAAC,aAAa,CAACG,OAAO,CAAEV,WAAY,CAAAM,QAAA,cACjD7C,IAAA,SAAM8C,SAAS,CAAC,2BAA2B,CAAAD,QAAA,CAAC,UAAQ,CAAM,CAAC,CACvD,CAAC,cAGT7C,IAAA,WACA8C,SAAS,CAAC,aAAa,CACvBG,OAAO,CAAEhC,eAAgB,CACzBiC,QAAQ,CAAExC,SAAS,EAAIJ,SAAS,CAACyC,UAAU,CAACI,IAAI,CAAC,CAAC,GAAK,EAAG,CAAAN,QAAA,cAEtD7C,IAAA,SAAM8C,SAAS,CAAC,2BAA2B,CAAAD,QAAA,CAAC,UAAQ,CAAM,CAAC,CACvD,CACX,EACA,CAAC,CACLnC,SAAS,cAEN;AACAR,KAAA,QAAK4C,SAAS,CAAC,uBAAuB,CAAAD,QAAA,eAClC7C,IAAA,SAAA6C,QAAA,CAAM,QAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,QAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,QAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,QAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,QAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,GAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,GAAC,CAAM,CAAC,cACd7C,IAAA,SAAA6C,QAAA,CAAM,GAAC,CAAM,CAAC,EACb,CAAC,cAGN7C,IAAA,MAAG8C,SAAS,CAAC,KAAK,CAAAD,QAAA,CAAC,kCAAO,CAAG,CAChC,cACD7C,IAAA,QAAI,CAAC,cACLA,IAAA,CAACF,eAAe,EAACU,QAAQ,CAAEA,QAAS,CAAE,CAAC,EACtC,CAAC,CACR,CAAC,CAEX,CAAC,CAED,cAAe,CAAAH,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}